\documentclass[10pt,a5paper]{book}
\usepackage[a5paper, hmargin=0.8cm, tmargin=0.3cm, bmargin=1cm, headheight=0.3cm, includehead]{geometry}  % includehead, showframe
\usepackage{multirow}
\usepackage[usenames, dvipsnames]{color}
\usepackage{xstring}
\usepackage{etoolbox}
\usepackage{multirow}
\usepackage{fancyhdr}
\usepackage{multido}
\usepackage{xkeyval}
\usepackage{ifthen}
\usepackage{graphicx}

\title{2024 - 2025}
\date{}

\input{weekdays.tex}

\newcommand{\colwidth}{%
  0.31\textwidth
}

\newcommand{\weekday}[2]{%
  \IfSubStr{#1}{#2}{\textcolor{red}{\scshape\weekdayname{#2}}}{\scshape\weekdayname{#2}}%
}

\newcommand{\daynum}[3]{%
  \IfSubStr{#1}{#2}{\textcolor{red}{\huge{#3}}}{\huge{#3}}%
}

\newcommand{\flagflying}[1]{%
  \def\flagfile{images/flag_#1.pdf}%
  \ifthenelse{\equal{#1}{}}{}{\includegraphics[height=6pt]{\flagfile}\,}%
}

\newcommand{\event}[2]{%
  \ifthenelse{\equal{#1}{}}{\dotfill}{\multirow{3}{\colwidth}{\flagflying{#2}\small{\textit{#1}}}}%
}

\newcommand{\eventspace}[1]{%
  \ifthenelse{\equal{#1}{}}{\dotfill}{}%
}

\newcommand{\satevent}[2]{%
  \ifthenelse{\equal{#1}{}}{\dotfill}{\multirow{4}{\colwidth}{\flagflying{#2}\small{\textit{#1}}}}%
}

\makeatletter
\define@key{weekfirsthalf}{mondate}{\def\Mondate{#1}}
\define@key{weekfirsthalf}{tuedate}{\def\Tuedate{#1}}
\define@key{weekfirsthalf}{weddate}{\def\Weddate{#1}}
\define@key{weekfirsthalf}{monevent}{\def\Monevent{#1}}
\define@key{weekfirsthalf}{tueevent}{\def\Tueevent{#1}}
\define@key{weekfirsthalf}{wedevent}{\def\Wedevent{#1}}
\define@key{weekfirsthalf}{monflag}{\def\Monflag{#1}}
\define@key{weekfirsthalf}{tueflag}{\def\Tueflag{#1}}
\define@key{weekfirsthalf}{wedflag}{\def\Wedflag{#1}}
\define@key{weekfirsthalf}{holidays}{\def\Holidays{#1}}
\define@key{weekfirsthalf}{weekinfo}{\def\Weekinfo{#1}}

\define@key{weeksecondhalf}{thudate}{\def\Thudate{#1}}
\define@key{weeksecondhalf}{fridate}{\def\Fridate{#1}}
\define@key{weeksecondhalf}{satdate}{\def\Satdate{#1}}
\define@key{weeksecondhalf}{sundate}{\def\Sundate{#1}}
\define@key{weeksecondhalf}{thuevent}{\def\Thuevent{#1}}
\define@key{weeksecondhalf}{frievent}{\def\Frievent{#1}}
\define@key{weeksecondhalf}{satevent}{\def\Satevent{#1}}
\define@key{weeksecondhalf}{sunevent}{\def\Sunevent{#1}}
\define@key{weeksecondhalf}{thuflag}{\def\Thuflag{#1}}
\define@key{weeksecondhalf}{friflag}{\def\Friflag{#1}}
\define@key{weeksecondhalf}{satflag}{\def\Satflag{#1}}
\define@key{weeksecondhalf}{sunflag}{\def\Sunflag{#1}}
\define@key{weeksecondhalf}{holidays}{\def\Holidays{#1}}
\makeatother

\newcommand{\weekfirsthalf}[1]{%
  \setkeys{weekfirsthalf}{#1}
  \begin{flushleft}
    \begin{tabular}{*{3}{p{\colwidth}}}
      \multicolumn{3}{l}{\textit{\scshape{\Weekinfo}}} \\[1ex]
      \weekday{\Holidays}{1} & \weekday{\Holidays}{2} & \weekday{\Holidays}{3} \\[0.5ex]
      \daynum{\Holidays}{1}{\Mondate} & \daynum{\Holidays}{2}{\Tuedate} &
      \daynum{\Holidays}{3}{\Weddate} \\
      & & \\
      8:00 \dotfill & 8:00 \dotfill & 8:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      9:00 \dotfill & 9:00 \dotfill & 9:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      10:00 \dotfill & 10:00 \dotfill & 10:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      11:00 \dotfill & 11:00 \dotfill & 11:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      12:00 \dotfill & 12:00 \dotfill & 12:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      13:00 \dotfill & 13:00 \dotfill & 13:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      14:00 \dotfill & 14:00 \dotfill & 14:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      15:00 \dotfill & 15:00 \dotfill & 15:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      16:00 \dotfill & 16:00 \dotfill & 16:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      17:00 \dotfill & 17:00 \dotfill & 17:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      18:00 \dotfill & 18:00 \dotfill & 18:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      19:00 \dotfill & 19:00 \dotfill & 19:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      20:00 \dotfill & 20:00 \dotfill & 20:00 \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      & & \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \event{\Monevent}{\Monflag} & \event{\Tueevent}{\Tueflag} & \event{\Wedevent}{\Wedflag} \\
      \eventspace{\Monevent} & \eventspace{\Tueevent} & \eventspace{\Wedevent} \\
      \eventspace{\Monevent} & \eventspace{\Tueevent} & \eventspace{\Wedevent} \\

    \end{tabular}
  \end{flushleft}
}

\newcommand{\weeksecondhalf}[1]{
  \setkeys{weeksecondhalf}{#1}
  \begin{flushleft}
    \begin{tabular}{*{3}{p{\colwidth}}}
      \multicolumn{3}{l}{} \\[1ex]
      \weekday{\Holidays}{4} & \weekday{\Holidays}{5} & \weekday{\Holidays}{6} \\[0.5ex]
      \daynum{\Holidays}{4}{\Thudate} & \daynum{\Holidays}{5}{\Fridate} &
      \daynum{\Holidays}{6}{\Satdate} \\
      & & \\
      8:00 \dotfill & 8:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      9:00 \dotfill & 9:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      10:00 \dotfill & 10:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      11:00 \dotfill & 11:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      12:00 \dotfill & 12:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      13:00 \dotfill & 13:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      14:00 \dotfill & 14:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \satevent{\Satevent}{\Satflag} \\
      15:00 \dotfill & 15:00 \dotfill & \eventspace{\Satevent} \\
      \dotfill & \dotfill & \eventspace{\Satevent} \\
      16:00 \dotfill & 16:00 \dotfill & \eventspace{\Satevent}\\
      \dotfill & \dotfill & \\
      17:00 \dotfill & 17:00 \dotfill & \weekday{\Holidays}{7} \\
      \dotfill & \dotfill & \multirow{2}*{\daynum{\Holidays}{7}{\Sundate}} \\
      18:00 \dotfill & 18:00 \dotfill & \\
      \dotfill & \dotfill & \dotfill \\
      19:00 \dotfill & 19:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      20:00 \dotfill & 20:00 \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      & & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \dotfill & \dotfill & \dotfill \\
      \event{\Thuevent}{\Thuflag} & \event{\Frievent}{\Friflag} & \event{\Sunevent}{\Sunflag} \\
      \eventspace{\Thuevent} & \eventspace{\Frievent} & \eventspace{\Sunevent} \\
      \eventspace{\Thuevent} & \eventspace{\Frievent} & \eventspace{\Sunevent} \\

    \end{tabular}
  \end{flushleft}
}

\newcommand{\memopage}{%
  \newpage
  \multido{}{44}{\noindent\makebox[\linewidth]{\dotfill}\endgraf}
}


\begin{document}

% Add two blank pages to the beginning so that there's one empty sheet
% before the title page.
\multido{}{2}{\shipout\null}

\maketitle

\pagestyle{fancy}

\fancyhead{}
\fancyfoot{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\headrule}{%
  \vspace{-11pt}
}
\fancyhead[LE,RO]{\tiny{\thepage}}

% \pagestyle{empty}
\input{cal-days.tex}

\multido{}{34}{\memopage}

%% Add empty pages to the end to fill in signatures. Adjust
%% the number as you need.
\multido{}{2}{\shipout\null}


\end{document}
